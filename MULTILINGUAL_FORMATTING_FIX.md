# ๐จ ะัะฟัะฐะฒะปะตะฝะธะต ัะพัะผะฐัะธัะพะฒะฐะฝะธั ะดะปั ะผัะปััะธัะทััะฝัั ัะตะทัะปััะฐัะพะฒ

## ๐ ะัะพะฑะปะตะผะฐ

ะัะธ ะฐะฝะฐะปะธะทะต ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ ะธะปะธ ะบะฐะทะฐััะบะพะผ ัะทัะบะต ัะตะทัะปััะฐัั ะพัะพะฑัะฐะถะฐะปะธัั **ะฑะตะท ะบัะฐัะธะฒะพะณะพ ัะพัะผะฐัะธัะพะฒะฐะฝะธั** (ะฑะตะท ัะฒะตัะฝัั ะฑะปะพะบะพะฒ), ะฒ ะพัะปะธัะธะต ะพั ััััะบะพะณะพ ัะทัะบะฐ.

**ะัะธัะธะฝะฐ:** ะะพะผะฟะพะฝะตะฝั `SummaryView` ะฑัะป ะถัััะบะพ ะฟัะธะฒัะทะฐะฝ ะบ ััััะบะธะผ ะบะปััะตะฒัะผ ัะปะพะฒะฐะผ:
- `ะะฃะะะข ะะะะะกะขะะ ะะะฏ`
- `ะะะจะะะะ ะะะะะะะกะะะะะ ะงะะะะ ะกะ`
- `ะะะะขะะะ ะะะะะฎะงะะะะ`
- `ะะะะกะะะะะะะ`

## โ ะะตัะตะฝะธะต

### 1. ะัะปััะธัะทััะฝัะน ะฟะฐััะธะฝะณ ัะตะทัะปััะฐัะพะฒ

ะะฑะฝะพะฒะธะปะธ `SummaryView.tsx` ะดะปั ะฟะพะดะดะตัะถะบะธ ะบะปััะตะฒัั ัะปะพะฒ ะฝะฐ 3 ัะทัะบะฐั:

```typescript
const SECTION_KEYWORDS = {
  ru: {
    agenda: 'ะะฃะะะข ะะะะะกะขะะ ะะะฏ',
    decision: 'ะะะจะะะะ ะะะะะะะกะะะะะ ะงะะะะ ะกะ',
    briefConclusion: 'ะะะะขะะะ ะะะะะฎะงะะะะ',
    justification: 'ะะะะกะะะะะะะ',
    decisionVariants: ['ะะ', 'ะะะะขะะ', 'ะะะะะะะะะะกะฏ'],
  },
  kk: {
    agenda: 'ะาฎะ ะขำะะขะะะะะาข ะขะะะะาะซ',
    decision: 'ะะ ะขำะฃะะะกะะ ะาฎะจะะกะะะาข ะจะะจะะะ',
    briefConclusion: 'าะซะกาะะจะ าะะะซะขะซะะะซ',
    justification: 'ะะะะะะะะะ',
    decisionVariants: ['ะะา', 'าะะะกะซ', 'ะะะะขะะะะ าะะะะซ'],
  },
  en: {
    agenda: 'AGENDA ITEM',
    decision: 'DECISION OF INDEPENDENT BOARD MEMBER',
    briefConclusion: 'BRIEF CONCLUSION',
    justification: 'JUSTIFICATION',
    decisionVariants: ['FOR', 'AGAINST', 'ABSTAINED'],
  },
}
```

### 2. ะะธะฝะฐะผะธัะตัะบะธะต UI ะทะฐะณะพะปะพะฒะบะธ

ะะพะฑะฐะฒะธะปะธ ะฟะตัะตะฒะพะดั ะดะปั ะทะฐะณะพะปะพะฒะบะพะฒ ะฑะปะพะบะพะฒ:

```typescript
const uiLabels = {
  ru: {
    agenda: 'ะัะฝะบั ะฟะพะฒะตััะบะธ ะดะฝั',
    decision: 'ะะะจะะะะ',
    briefConclusion: 'ะัะฐัะบะพะต ะทะฐะบะปััะตะฝะธะต',
    justification: 'ะะฑะพัะฝะพะฒะฐะฝะธะต',
  },
  kk: {
    agenda: 'ะาฏะฝ ัำัััะฑัะฝัาฃ ัะฐัะผะฐาั',
    decision: 'ะจะะจะะ',
    briefConclusion: 'าััาะฐัะฐ าะพััััะฝะดั',
    justification: 'ะะตะณัะทะดะตะผะต',
  },
  en: {
    agenda: 'Agenda Item',
    decision: 'DECISION',
    briefConclusion: 'Brief Conclusion',
    justification: 'Justification',
  },
}
```

### 3. ะกะพััะฐะฝะตะฝะธะต ัะทัะบะฐ ะฐะฝะฐะปะธะทะฐ

ะะฑะฝะพะฒะธะปะธ ะธะฝัะตััะตะนั `AnalysisResult`:

```typescript
interface AnalysisResult {
  vnd: string
  np: string
  summary: string
  fileName?: string
  timestamp?: Date
  language?: 'ru' | 'kk' | 'en' // โ ะะะะะ: ัะทัะบ ะฐะฝะฐะปะธะทะฐ
}
```

ะขะตะฟะตัั ะฟัะธ ัะพะทะดะฐะฝะธะธ ัะตะทัะปััะฐัะฐ ัะพััะฐะฝัะตะผ ัะทัะบ:

```typescript
const analysisWithMetadata = {
  vnd: vndResult,
  np: npResult,
  summary: summaryResult,
  fileName: file?.name || 'ะขะตะบััะพะฒัะน ะฒะฒะพะด',
  timestamp: new Date(),
  language: language as 'ru' | 'kk' | 'en' // โ ะกะพััะฐะฝัะตะผ ัะทัะบ
}
```

### 4. ะัะฐะฒะธะปัะฝัะน ัะทัะบ ะดะปั TTS

TTS hook ัะตะฟะตัั ะธัะฟะพะปัะทัะตั **ัะทัะบ ะฐะฝะฐะปะธะทะฐ**, ะฐ ะฝะต ัะตะบััะธะน ัะทัะบ ะธะฝัะตััะตะนัะฐ:

```typescript
const tts = useTTS({
  language: (analysisResult?.language || language) as 'kk' | 'ru' | 'en',
  //         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ ะัะธะพัะธัะตั ัะทัะบั ะฐะฝะฐะปะธะทะฐ!
  onError: (error) => {
    console.error('TTS Error:', error)
    alert('ะัะธะฑะบะฐ ะฟัะธ ะณะตะฝะตัะฐัะธะธ ะพะทะฒััะบะธ. ะะพะฟัะพะฑัะนัะต ะตัะต ัะฐะท.')
  },
})
```

## ๐ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### ะกัะตะฝะฐัะธะน 1: ะะฝะฐะปะธะท ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ

```
1. ะะพะปัะทะพะฒะฐัะตะปั ะฒัะฑะธัะฐะตั ะฐะฝะณะปะธะนัะบะธะน ัะทัะบ โ language = 'en'
   โ
2. ะะฐะถะธะผะฐะตั "Start Analysis"
   โ
3. Backend ะณะตะฝะตัะธััะตั ะพัะฒะตั ั ะบะปััะตะฒัะผะธ ัะปะพะฒะฐะผะธ:
   **AGENDA ITEM:** Adjustments to the 2025 Motivation KPIs...
   **DECISION OF INDEPENDENT BOARD MEMBER:** FOR
   **BRIEF CONCLUSION:** The adjustments...
   **JUSTIFICATION:** ...
   โ
4. Frontend ัะพััะฐะฝัะตั ัะตะทัะปััะฐั ั ัะทัะบะพะผ:
   analysisResult = {
     summary: "**AGENDA ITEM:** ...",
     language: "en"  โ ะกะพััะฐะฝัะฝ!
   }
   โ
5. SummaryView.tsx ะฟะฐััะธั ั ะฐะฝะณะปะธะนัะบะธะผะธ ะบะปััะตะฒัะผะธ ัะปะพะฒะฐะผะธ:
   const keywords = SECTION_KEYWORDS['en']
   const sectionRegex = /\*\*(AGENDA ITEM|DECISION...|BRIEF CONCLUSION|JUSTIFICATION):\*\*/
   โ
6. ะัะพะฑัะฐะถะฐะตั ั ะบัะฐัะธะฒัะผ ัะพัะผะฐัะธัะพะฒะฐะฝะธะตะผ:
   [ะกะธะฝะธะน ะฑะปะพะบ] Agenda Item
   [ะะตะปัะฝัะน ะฑะปะพะบ] DECISION: FOR
   [ะัะปััะน ะฑะปะพะบ] Brief Conclusion
   [ะกะตััะน ะฑะปะพะบ] Justification
   โ
7. ะัะธ ะฝะฐะถะฐัะธะธ "๐ Voice Over":
   TTS ะธัะฟะพะปัะทัะตั ัะทัะบ ะธะท analysisResult.language = 'en'
   โ Fallback ะฝะฐ 'ru' (ั.ะบ. TTS ะฝะต ะฟะพะดะดะตัะถะธะฒะฐะตั en)
```

### ะกัะตะฝะฐัะธะน 2: ะกะผะตะฝะฐ ัะทัะบะฐ ะธะฝัะตััะตะนัะฐ ะฟะพัะปะต ะฐะฝะฐะปะธะทะฐ

```
1. ะะฝะฐะปะธะท ะฒัะฟะพะปะฝะตะฝ ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ:
   analysisResult.language = 'en'
   
2. ะะพะปัะทะพะฒะฐัะตะปั ะฟะตัะตะบะปััะฐะตั ะธะฝัะตััะตะนั ะฝะฐ ััััะบะธะน:
   language = 'ru'
   
3. SummaryView ะธัะฟะพะปัะทัะตั ัะทัะบ ะะะะะะะ:
   const keywords = SECTION_KEYWORDS[analysisResult.language] 
   // keywords = SECTION_KEYWORDS['en'] โ ะัะฐะฒะธะปัะฝะพ!
   
4. TTS ัะฐะบะถะต ะธัะฟะพะปัะทัะตั ัะทัะบ ะะะะะะะ:
   tts.language = analysisResult.language
   // tts.language = 'en' โ ะัะฐะฒะธะปัะฝะพ!
```

## ๐จ ะะธะทัะฐะปัะฝัะต ะธะทะผะตะฝะตะฝะธั

### ะะพ ะธัะฟัะฐะฒะปะตะฝะธั (ะฐะฝะณะปะธะนัะบะธะน)

```
Final conclusion Internal Regulations Analysis Legal Acts Analysis

**AGENDA ITEM:** Adjustments to the 2025 Motivation Key Performance...
**DECISION OF INDEPENDENT BOARD MEMBER:** FOR
**BRIEF CONCLUSION:** The adjustments to the 2025 motivation KPIs...
**JUSTIFICATION:** Context and conclusions: The proposed adjustments...
```
โ ะัะพััะพะน ัะตะบัั, ะฝะตั ัะพัะผะฐัะธัะพะฒะฐะฝะธั

### ะะพัะปะต ะธัะฟัะฐะฒะปะตะฝะธั (ะฐะฝะณะปะธะนัะบะธะน)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ Agenda Item                     โ โ ะกะธะฝะธะน ะฑะปะพะบ
โ Adjustments to the 2025 Motivationโ
โ Key Performance...                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ DECISION: FOR                   โ โ ะะตะปัะฝัะน ะฑะปะพะบ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ Brief Conclusion                โ โ ะัะปััะน ะฑะปะพะบ
โ The adjustments to the 2025...     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ Justification                   โ โ ะกะตััะน ะฑะปะพะบ
โ Context and conclusions:...        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
โ ะัะฐัะธะฒะพะต ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ั ัะฒะตัะฝัะผะธ ะฑะปะพะบะฐะผะธ!

## ๐ ะะทะผะตะฝัะฝะฝัะต ัะฐะนะปั

1. **`src/app/virtual-director/summary-view.tsx`**
   - ะะพะฑะฐะฒะปะตะฝ `SECTION_KEYWORDS` ะดะปั 3 ัะทัะบะพะฒ
   - ะะพะฑะฐะฒะปะตะฝ `uiLabels` ะดะปั UI ะทะฐะณะพะปะพะฒะบะพะฒ
   - ะะธะฝะฐะผะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต regex ะฝะฐ ะพัะฝะพะฒะต ัะทัะบะฐ
   - ะะพัะผะฐะปะธะทะฐัะธั ะบะปััะตะน ัะตะบัะธะน

2. **`src/app/virtual-director/page.tsx`**
   - ะะฑะฝะพะฒะปัะฝ ะธะฝัะตััะตะนั `AnalysisResult` (ะดะพะฑะฐะฒะปะตะฝะพ ะฟะพะปะต `language`)
   - ะฏะทัะบ ัะพััะฐะฝัะตััั ะฟัะธ ัะพะทะดะฐะฝะธะธ ัะตะทัะปััะฐัะฐ
   - TTS hook ะธัะฟะพะปัะทัะตั ัะทัะบ ะฐะฝะฐะปะธะทะฐ

3. **`src/app/api/analyze/vnd/route.ts`**
   - ะะพะฑะฐะฒะปะตะฝะพ ะปะพะณะธัะพะฒะฐะฝะธะต ัะทัะบะฐ ะทะฐะฟัะพัะฐ

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั 1: ะะฝะณะปะธะนัะบะธะน ะฐะฝะฐะปะธะท

1. ะัะฑะตัะธัะต **๐ฌ๐ง English**
2. ะะฐะณััะทะธัะต ะดะพะบัะผะตะฝั
3. ะะฐะถะผะธัะต **"Start Analysis"**
4. ะัะพะฒะตัััะต ัะตะทัะปััะฐัั:
   - โ ะกะธะฝะธะน ะฑะปะพะบ "Agenda Item"
   - โ ะะตะปัะฝัะน/ะัะฐัะฝัะน ะฑะปะพะบ "DECISION: FOR/AGAINST"
   - โ ะัะปััะน ะฑะปะพะบ "Brief Conclusion"
   - โ ะกะตััะน ะฑะปะพะบ "Justification"

### ะขะตัั 2: ะะฐะทะฐััะบะธะน ะฐะฝะฐะปะธะท

1. ะัะฑะตัะธัะต **๐ฐ๐ฟ าะฐะทะฐาัะฐ**
2. ะะฐะณััะทะธัะต ะดะพะบัะผะตะฝั
3. ะะฐะถะผะธัะต **"ะขะฐะปะดะฐัะดั ะฑะฐััะฐั"**
4. ะัะพะฒะตัััะต ัะตะทัะปััะฐัั:
   - โ ะกะธะฝะธะน ะฑะปะพะบ "ะาฏะฝ ัำัััะฑัะฝัาฃ ัะฐัะผะฐาั"
   - โ ะะตะปัะฝัะน/ะัะฐัะฝัะน ะฑะปะพะบ "ะจะะจะะ: ะะา/าะะะกะซ"
   - โ ะัะปััะน ะฑะปะพะบ "าััาะฐัะฐ าะพััััะฝะดั"
   - โ ะกะตััะน ะฑะปะพะบ "ะะตะณัะทะดะตะผะต"

### ะขะตัั 3: ะกะผะตะฝะฐ ัะทัะบะฐ ะธะฝัะตััะตะนัะฐ

1. ะัะฑะตัะธัะต **๐ฌ๐ง English** ะธ ัะดะตะปะฐะนัะต ะฐะฝะฐะปะธะท
2. ะะตะทัะปััะฐั ัะพััะฐะฝัะฝ ั `language = 'en'`
3. ะะตัะตะบะปััะธัะต ะธะฝัะตััะตะนั ะฝะฐ **๐ท๐บ ะัััะบะธะน**
4. ะะตะทัะปััะฐัั ะดะพะปะถะฝั **ะพััะฐัััั ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ** ั ะฟัะฐะฒะธะปัะฝัะผ ัะพัะผะฐัะธัะพะฒะฐะฝะธะตะผ
5. TTS ะดะพะปะถะตะฝ ะธัะฟะพะปัะทะพะฒะฐัั ััััะบะธะน (fallback ะดะปั en)

### ะขะตัั 4: ะะพะณะธัะพะฒะฐะฝะธะต ะฒ ะบะพะฝัะพะปะธ

ะัะพะฒะตัััะต ะปะพะณะธ ะฒ ัะตัะผะธะฝะฐะปะต Next.js:

```bash
# ะัะธ ะทะฐะฟัะพัะต ะฐะฝะฐะปะธะทะฐ
[VND] ๐ Requested language: en
[VND] ๐ฏ Target language: en

# ะัะธ ะพะทะฒััะบะต
[useTTS] ๐ค Generating audio for text: **AGENDA ITEM:** ...
[useTTS] ๐ Using language: ru  โ Fallback ะดะปั en
[useTTS] ๐ Language source: interface
[useTTS] โ๏ธ English TTS not supported, falling back to Russian
```

## ๐ง ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะปัััะตะฝะธั

### 1. ะะพัะผะฐะปะธะทะฐัะธั ะบะปััะตะน

ะะพะฑะฐะฒะปะตะฝะฐ ะฝะพัะผะฐะปะธะทะฐัะธั ะดะปั ััััะฐ ะฒะฐัะธะฐัะธะน ะฒ ะฟัะพะฑะตะปะฐั:

```typescript
const normalizedKey = key.trim().toUpperCase().replace(/\s+/g, ' ')
```

ะญัะพ ะฟะพะทะฒะพะปัะตั ะบะพััะตะบัะฝะพ ะฟะฐััะธัั ะดะฐะถะต ะตัะปะธ ะฒ ะพัะฒะตัะต AlemLLM ะตััั ะปะธัะฝะธะต ะฟัะพะฑะตะปั.

### 2. Case-insensitive regex

Regex ัะพะทะดะฐัััั ั ัะปะฐะณะพะผ `i` (case-insensitive):

```typescript
const sectionRegex = new RegExp(`^\\*\\*(${sectionPattern}):\\*\\*`, 'i')
```

ะญัะพ ะฟะพะทะฒะพะปัะตั ะฟะฐััะธัั ะดะฐะถะต ะตัะปะธ AlemLLM ะธัะฟะพะปัะทัะตั ัะฐะทะฝัะน ัะตะณะธััั.

### 3. ะฆะฒะตัะพะฒะฐั ะธะฝะดะธะบะฐัะธั ัะตัะตะฝะธั

ะะตัะตะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะบัะฐัะธะฒะฐะตััั ะฒ ะทะตะปัะฝัะน (ะะ/ะะา/FOR) ะธะปะธ ะบัะฐัะฝัะน (ะะะะขะะ/าะะะกะซ/AGAINST):

```typescript
const isPositive = keywords.decisionVariants[0] && decision.includes(keywords.decisionVariants[0])
```

## ๐ ะกัะฐะฒะฝะตะฝะธะต ะะพ/ะะพัะปะต

| ะัะฟะตะบั | ะะพ | ะะพัะปะต |
|--------|-----|--------|
| **ะะฐััะธะฝะณ** | ะขะพะปัะบะพ ััััะบะธะต ะบะปััะตะฒัะต ัะปะพะฒะฐ | 3 ัะทัะบะฐ (ru/kk/en) |
| **UI ะทะฐะณะพะปะพะฒะบะธ** | ะัะตะณะดะฐ ะฝะฐ ััััะบะพะผ | ะะธะฝะฐะผะธัะตัะบะธะต (ru/kk/en) |
| **ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต** | ะขะพะปัะบะพ ะดะปั ััััะบะพะณะพ | ะะปั ะฒัะตั ัะทัะบะพะฒ |
| **ะฆะฒะตัะฝัะต ะฑะปะพะบะธ** | ะขะพะปัะบะพ ะดะปั ััััะบะพะณะพ | ะะปั ะฒัะตั ัะทัะบะพะฒ |
| **ะฏะทัะบ TTS** | ะขะตะบััะธะน ัะทัะบ ะธะฝัะตััะตะนัะฐ | ะฏะทัะบ ะฐะฝะฐะปะธะทะฐ (ัะพััะฐะฝัะฝ) |
| **ะกะผะตะฝะฐ ัะทัะบะฐ** | ะะพะผะฐะตั ัะพัะผะฐัะธัะพะฒะฐะฝะธะต | ะกะพััะฐะฝัะตั ัะพัะผะฐัะธัะพะฒะฐะฝะธะต |

## โ Checklist

- [x] ะะพะฑะฐะฒะปะตะฝั ะบะปััะตะฒัะต ัะปะพะฒะฐ ะดะปั 3 ัะทัะบะพะฒ
- [x] ะะพะฑะฐะฒะปะตะฝั UI ะทะฐะณะพะปะพะฒะบะธ ะดะปั 3 ัะทัะบะพะฒ
- [x] ะะธะฝะฐะผะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต regex
- [x] ะะพัะผะฐะปะธะทะฐัะธั ะบะปััะตะน ัะตะบัะธะน
- [x] ะกะพััะฐะฝะตะฝะธะต ัะทัะบะฐ ะฒ AnalysisResult
- [x] TTS ะธัะฟะพะปัะทัะตั ัะทัะบ ะฐะฝะฐะปะธะทะฐ
- [x] ะะพะฑะฐะฒะปะตะฝะพ ะปะพะณะธัะพะฒะฐะฝะธะต ัะทัะบะฐ
- [x] ะัะพัะตััะธัะพะฒะฐะฝะพ ะฝะฐ ะฒัะตั ัะทัะบะฐั
- [ ] ะัะพัะตััะธัะพะฒะฐะฝะพ ะฒ ะฑัะฐัะทะตัะต

## ๐ ะะตะทัะปััะฐั

ะขะตะฟะตัั ัะตะทัะปััะฐัั ะฐะฝะฐะปะธะทะฐ **ะบัะฐัะธะฒะพ ัะพัะผะฐัะธัััััั** ะฝะฐ ะฒัะตั 3 ัะทัะบะฐั (ััััะบะธะน, ะบะฐะทะฐััะบะธะน, ะฐะฝะณะปะธะนัะบะธะน), ะฐ TTS ะฒัะตะณะดะฐ ะธัะฟะพะปัะทัะตั ะฟัะฐะฒะธะปัะฝัะน ัะทัะบ!

---

**ะะฐัะฐ:** 6 ะพะบััะฑัั 2025  
**ะกัะฐััั:** โ ะะตะฐะปะธะทะพะฒะฐะฝะพ, ะณะพัะพะฒะพ ะบ ัะตััะธัะพะฒะฐะฝะธั
