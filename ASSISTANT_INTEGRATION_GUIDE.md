# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Avatar Chat Test –≤ Next.js –ø—Ä–æ–µ–∫—Ç

## üìù –û–±–∑–æ—Ä

–£—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ avatar-chat-test Express —Å–µ—Ä–≤–µ—Ä–∞ –≤ Next.js –ø—Ä–æ–µ–∫—Ç. –¢–µ–ø–µ—Ä—å –ø—Ä–æ–µ–∫—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π** –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—Å–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É 3000.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
```bash
npm install axios
```

### 2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env.local)**
–î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ API –∫–ª—é—á–∏ –∏ endpoints:

```env
# Azure OpenAI Configuration
AZURE_OPENAI_ENDPOINT="https://a-ass55.openai.azure.com/"
AZURE_OPENAI_API_KEY="..."
AZURE_OPENAI_API_VERSION="2024-05-01-preview"

# Nitec AI Configuration  
NITEC_AI_ENDPOINT="https://nitec-ai.kz/api/chat/completions"
NITEC_AI_BEARER_TOKEN="..."

# SerpAPI Configuration
SERPAPI_API_KEY="..."

# DB Webhook Configuration
DB_WEBHOOK_URL="https://gshsh.nitec-ai.kz/webhook/..."
```

### 3. **–£—Ç–∏–ª–∏—Ç—ã (/src/lib/assistant-utils.ts)**
–°–æ–∑–¥–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏:

#### `performSerpAPISearch(query, focus)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ Google (SerpAPI)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `query`: –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
  - `focus`: "general" | "law" | "practices"
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
  - `law`: –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –Ω–∞ adilet.zan.kz (–∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ)
  - `practices`: –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
  - `general`: –æ–±—â–∏–π –ø–æ–∏—Å–∫

#### `callNitecAI(model, userQuery)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª—è–º Nitec AI
- **–ú–æ–¥–µ–ª–∏**:
  - `1_recom_db`: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤—Å—Ç—Ä–µ—á
  - `1_recom_andrei`: –æ–±–∑–æ—Ä —Å–∏—Ç—É–∞—Ü–∏–∏ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ

#### `callDatabaseWebhook(message)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å –∫ –ë–î —á–µ—Ä–µ–∑ webhook
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: –æ—Ç–≤–µ—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 4. **API Routes (/src/app/api/assistant/route.ts)**
–°–æ–∑–¥–∞–Ω Next.js API endpoint –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞:

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

**1. `db_query`**
```typescript
{
  function_name: "db_query",
  arguments: { message: "–≤–∞—à –≤–æ–ø—Ä–æ—Å" }
}
```
–ó–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ webhook.

**2. `law_based_answering`**
```typescript
{
  function_name: "law_based_answering",
  arguments: { legal_query: "–ø—Ä–∞–≤–æ–≤–æ–π –≤–æ–ø—Ä–æ—Å" }
}
```
–ü–æ–∏—Å–∫ –ø—Ä–∞–≤–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ adilet.zan.kz.

**3. `next_meeting_recommendation`**
```typescript
{
  function_name: "next_meeting_recommendation",
  arguments: { meeting_topic: "—Ç–µ–º–∞ –≤—Å—Ç—Ä–µ—á–∏" }
}
```
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –≤—Å—Ç—Ä–µ—á (Nitec AI).

**4. `best_practices_search`**
```typescript
{
  function_name: "best_practices_search",
  arguments: { practice_query: "—Ç–µ–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞" }
}
```
–ü–æ–∏—Å–∫ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫.

**5. `overview_situation_kazakhstan`**
```typescript
{
  function_name: "overview_situation_kazakhstan",
  arguments: { situation_query: "—Å–∏—Ç—É–∞—Ü–∏—è" }
}
```
–û–±–∑–æ—Ä —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ (Nitec AI).

### 5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Avatar Page**
–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/avatar` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π API:
- **–ë—ã–ª–æ**: `http://localhost:3000/api/assistant`
- **–°—Ç–∞–ª–æ**: `/api/assistant`

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ assistant-utils.ts          # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ assistant/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # API endpoint –¥–ª—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ avatar/
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                # –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤–∞—Ç–∞—Ä–∞
.env.local                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API –∫–ª—é—á–µ–π
```

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] 
    ‚Üì
[Avatar Page] 
    ‚Üì fetch('/api/assistant')
[/api/assistant/route.ts]
    ‚Üì
[assistant-utils.ts]
    ‚Üì ‚Üì ‚Üì
    ‚îú‚îÄ‚Üí [SerpAPI] (–ø–æ–∏—Å–∫)
    ‚îú‚îÄ‚Üí [Nitec AI] (AI –º–æ–¥–µ–ª–∏)
    ‚îî‚îÄ‚Üí [DB Webhook] (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
    ‚Üì
[–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é]
```

## üöÄ –ó–∞–ø—É—Å–∫

**–î–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** (—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å 2 —Å–µ—Ä–≤–µ—Ä–∞):
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1
cd avatar-chat-test && node server.js

# –¢–µ—Ä–º–∏–Ω–∞–ª 2
npm run dev
```

**–ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä):
```bash
npm run dev
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
```bash
npm run dev
```

### 2. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤–∞—Ç–∞—Ä–∞
```
http://localhost:3001/avatar
```

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
- ‚úÖ –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å (db_query)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–∑–≤—É—á–∫—É
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —è–∑—ã–∫ —á–µ—Ä–µ–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
–í –∫–æ–Ω—Å–æ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
üåê –ó–∞–ø—Ä–æ—Å –∫ /api/assistant
üì¶ Payload: { function_name: 'db_query', arguments: { message: '...' } }
üåç –Ø–∑—ã–∫ –∞–≤–∞—Ç–∞—Ä–∞: ru
```

–í —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ª–æ–≥–∞—Ö (—Ç–µ—Ä–º–∏–Ω–∞–ª):
```
===========================================
>>> Government Assistant API
üì• Incoming request:
   Function: db_query
   Arguments: { "message": "..." }
===========================================
üîÑ Processing db_query...
üóÑÔ∏è  [DB] Starting database request...
‚úÖ Received response from DB (X characters)
```

## üîë –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –í—Å–µ API –∫–ª—é—á–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `.env.local`, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git (.gitignore)
- ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Next.js API routes)
- ‚úÖ –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –î–æ
- ‚ùå –¢—Ä–µ–±–æ–≤–∞–ª–æ—Å—å 2 —Å–µ—Ä–≤–µ—Ä–∞ (Next.js + Express)
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- ‚ùå CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚ùå –°–ª–æ–∂–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–æ—Å–ª–µ
- ‚úÖ –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä (Next.js)
- ‚úÖ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å
- ‚úÖ –ù–µ—Ç CORS –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- ‚úÖ TypeScript —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- ‚úÖ –ï–¥–∏–Ω–∞—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞

## üóëÔ∏è –ß—Ç–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å:
```bash
rm -rf avatar-chat-test/
```

**–ù–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å** –¥–ª—è reference –∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –±—É–¥—É—â–∏—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫.

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–¢–∞–π–º–∞—É—Ç—ã**:
   - SerpAPI: 20 —Å–µ–∫—É–Ω–¥
   - Nitec AI: 30 —Å–µ–∫—É–Ω–¥
   - DB Webhook: 60 —Å–µ–∫—É–Ω–¥

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥—Ä–æ–±–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –í—Å–µ –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

4. **–Ø–∑—ã–∫–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –†–∞–±–æ—Ç–∞–µ—Ç —Å —è–∑—ã–∫–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ (ru/kk/en)

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–µ–∫—Ç SKAI —Ç–µ–ø–µ—Ä—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π** –∏ –≤–∫–ª—é—á–∞–µ—Ç:
- ‚úÖ AI –∞–≤–∞—Ç–∞—Ä —Å –≥–æ–ª–æ—Å–æ–≤—ã–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º
- ‚úÖ –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (ru/kk/en)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É
- ‚úÖ –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
- ‚úÖ AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- ‚úÖ –í—Å–µ API –≤–Ω—É—Ç—Ä–∏ Next.js –ø—Ä–æ–µ–∫—Ç–∞

---

**–î–∞—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ
